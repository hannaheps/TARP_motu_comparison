theme_bw()+
labs(shape = "spatial scale", fill = 'exposure', colour = 'exposure')+
guides(fill = guide_legend(override.aes = list(shape=22)))+
theme(panel.grid.major = element_blank(), # remove gridlines
panel.grid.minor = element_blank(), #remove gridlines
strip.background = element_blank(),
legend.position = c(.8,.8),
axis.text = element_text(size = 14),
axis.title.y = element_text(size = 14),
legend.box = "horizontal",
legend.box.background = element_rect(colour = "black"))
seabird_focal_all_meta_long2<-
seabird_focal_all_meta_long%>%
mutate(spatial_scale = fct_relevel(spatial_scale, c("100m", "200m", "side", "motu")))
seabird_rat_log_int_plot_box<-
seabird_focal_all_meta_long2%>%
mutate(rat.eradication.status = fct_relevel(rat.eradication.status, c('None', 'eradicated_2018', 'eradicated_2022')))%>%
ggplot(aes(x = rat.eradication.status, y = log(breeding_biomass+1)))+
geom_boxplot(aes(group = rat.eradication.status), alpha = .5, outlier.shape = NA, fill = c('#2F9D3E', '#F2BB05', '#CD1913'))+
geom_point(aes(shape = spatial_scale, fill = protection, colour = protection, group = protection), position = position_dodge(0.2), size = 2.5, alpha = .7)+
scale_fill_manual(values = c('white','black'), labels = c('windward', 'leeward'))+
scale_color_manual(values = c('black','black'), labels = c('windward', 'leeward')) +
scale_shape_manual(values = c(22, 24, 23, 21))+
ylab(bquote(Seabird~breeding~biomass~(log~kg~ha^-1)))+
#ylab("Seabird breeding biomass (log kg/ha)")+
xlab("")+
scale_x_discrete(labels = c('reference','recovering','unrestored'))+
theme_bw()+
labs(shape = "spatial scale", fill = 'exposure', colour = 'exposure')+
guides(fill = guide_legend(override.aes = list(shape=22)))+
theme(panel.grid.major = element_blank(), # remove gridlines
panel.grid.minor = element_blank(), #remove gridlines
strip.background = element_blank(),
legend.position = c(.8,.8),
axis.text = element_text(size = 14),
axis.title.y = element_text(size = 14),
legend.box = "horizontal",
legend.box.background = element_rect(colour = "black"))
seabird_rat_log_int_plot_box
#get estimates using emmeans:-----
sb_br_bio_space_mod_log_lm_int %>%
emmeans(~ protection|rat.eradication.status,
type = "response")
EMM_rat <- emmeans(sb_br_bio_space_mod_log_lm_int, ~ protection * rat.eradication.status)
pairs(EMM_rat, simple = "rat.eradication.status", type = "response")
pairs(EMM_rat, simple = "protection", type = "response")
pairs(EMM_rat, simple = "protection", regrid = "response")
pairs(EMM_rat, simple = "protection", type = "response", regrid = "response")
test(emmeans(sb_br_bio_space_mod_log_lm_int, ~ protection|rat.eradication.status,
type = "response"))
test(emmeans(sb_br_bio_space_mod_log_lm_int, ~ protection * rat.eradication.status, type = "response"))
test(pairs(emmeans(sb_br_bio_space_mod_log_lm_int, ~ protection * rat.eradication.status, type = "response")))
test(pairs(emmeans(sb_br_bio_space_mod_log_lm_int, ~ protection * rat.eradication.status, type = "response"), type = "response"))
test(pairs(emmeans(sb_br_bio_space_mod_log_lm_int, ~ protection * rat.eradication.status, type = "response"), type = "response"), type = "response")
#get estimates using emmeans:-----
EMM_rat <- emmeans(sb_br_bio_space_mod_log_lm_int, ~ protection * rat.eradication.status)
test(pairs(EMM_rat, by = "protection"), by = NULL, adjust = "fdr")
test(pairs(EMM_rat, by = "protection"), by = NULL, adjust = "fdr")
pairs(EMM_rat, simple = "protection", type = "response", regrid = "response")
pairs(EMM_rat, simple = "protection", type = "response", regrid = "response")
#get estimates using emmeans:-----
EMM_rat <- emmeans(sb_br_bio_space_mod_log_lm_int, ~ protection * rat.eradication.status, type = "response")
pairs(EMM_rat, simple = "protection", type = "response", regrid = "response")
test(pairs(emmeans(sb_br_bio_space_mod_log_lm_int, ~ protection * rat.eradication.status, type = "response"), type = "response"), type = "response")
test(emmeans(sb_br_bio_space_mod_log_lm_int, ~ protection|rat.eradication.status, type = "response"))
emmeans(sb_br_bio_space_mod_log_lm_int, list(revpairwise ~ rat.eradication.status), type = "response", adjust = "fdr")
emmeans(sb_br_bio_space_mod_log_lm_int, list(pairwise ~ rat.eradication.status), type = "response", adjust = "fdr")
emmeans(sb_br_bio_space_mod_log_lm_int, list(pairwise ~ rat.eradication.status, type = "response"), type = "response", adjust = "fdr")
emmeans(sb_br_bio_space_mod_log_lm_int, list(pairwise ~ rat.eradication.status), regrid = "response", adjust = "fdr")
emmeans(sb_br_bio_space_mod_log_lm_int, list(pairwise ~ rat.eradication.status),  adjust = "fdr")
#get estimates using emmeans:-----
EMM_rat <- emmeans(sb_br_bio_space_mod_log_lm_int, ~ protection * rat.eradication.status)
test(emmeans(sb_br_bio_space_mod_log_lm_int, ~ protection|rat.eradication.status, type = "response"))
test(emmeans(sb_br_bio_space_mod_log_lm_int, ~ protection|rat.eradication.status, type = "response"))
test(pairs(emmeans(sb_br_bio_space_mod_log_lm_int, ~ protection * rat.eradication.status, type = "response"), type = "response"), type = "response")
pairs(EMM_rat, simple = "protection", type = "response", regrid = "response")
emmeans(sb_br_bio_space_mod_log_lm_int, list(pairwise ~ rat.eradication.status),  adjust = "fdr")
emmeans(sb_br_bio_space_mod_log_lm_int, list(pairwise ~ rat.eradication.status), regrid = "response", adjust = "fdr")
emmeans(sb_br_bio_space_mod_log_lm_int, list(pairwise ~  protection * rat.eradication.status), regrid = "response", adjust = "fdr")
emmeans(sb_br_bio_space_mod_log_lm_int, list(pairwise ~  protection * rat.eradication.status), simple = "protection", regrid = "response", adjust = "fdr")
emmeans(sb_br_bio_space_mod_log_lm_int, list(pairwise ~  protection * rat.eradication.status), simple = "protection", adjust = "fdr")
pairs(emmeans(sb_br_bio_space_mod_log_lm_int, ~ protection * rat.eradication.status), simple = "protection", type = "response", regrid = "response", adjust = "fdr")
pairs(emmeans(sb_br_bio_space_mod_log_lm_int, ~ protection * rat.eradication.status, adjust = "fdr"), simple = "protection", type = "response", regrid = "response")
#make with spectral cover package:------
library(RColorBrewer)
sb_dens_stack_plot2<-
sb_dat_focal_nests_motu_sp%>%
ggplot(aes(fill = SpeciesName, y = Density_ha, x = Motu))+
geom_bar(position = "stack", stat =  "identity")+
ylab("Seabird breeding density (individuals/ha)")+
xlab("")+
scale_fill_brewer(palette = "Spectral",  name = "Species",
breaks=c("Aminutus",  "Astolidus", "Galba",  "Ssula"),
labels=c("Anous minutus (black noddy)", "Anous stolidus (brown noddy)", "Gygis alba (white tern)", "Sula sula (red-footed booby)")
)+ #
scale_x_discrete(labels = c('reference','recovering','unrestored'))+
theme_bw()+
theme(panel.grid.major = element_blank(), # remove gridlines
panel.grid.minor = element_blank(), #remove gridlines
strip.background = element_blank(),
legend.position = c(.75,.8),
axis.text=element_text(size=12),
axis.title=element_text(size=12)
)
sb_dens_stack_plot2
sb_bio_stack_plot2<-
sb_dat_focal_nests_motu_sp%>%
ggplot(aes(fill = SpeciesName, y = biomass_kg_ha, x = Motu))+
geom_bar(position = "stack", stat =  "identity")+
ylab("Seabird breeding biomass (kg/ha)")+
xlab("")+
scale_fill_brewer( palette = "Spectral",
name = "Species",
breaks=c("Aminutus",  "Astolidus", "Galba",  "Ssula"),
labels=c("Anous minutus (black noddy)", "Anous stolidus (brown noddy)", "Gygis alba (white tern)", "Sula sula (red-footed booby)")
)+
scale_x_discrete(labels = c('reference','recovering','unrestored'))+
theme_bw()+
theme(panel.grid.major = element_blank(), # remove gridlines
panel.grid.minor = element_blank(), #remove gridlines
strip.background = element_blank(),
# legend.position = c(.75,.8)
legend.position = "none",
axis.text=element_text(size=12),
axis.title=element_text(size=12)
)
sb_bio_stack_plot2
seabird_stack_plots2<-plot_grid(sb_bio_stack_plot2, sb_dens_stack_plot2, labels = "auto", label_fontface = "plain")
seabird_stack_plots2
sb_bio_stack_plot2<-
sb_dat_focal_nests_motu_sp%>%
ggplot(aes(fill = SpeciesName, y = biomass_kg_ha, x = Motu))+
geom_bar(position = "stack", stat =  "identity")+
ylab("Seabird breeding biomass (kg/ha)")+
xlab("")+
scale_fill_brewer( palette = "Spectral",
name = "Species",
breaks=c("Aminutus",  "Astolidus", "Galba",  "Ssula"),
# labels=c("Anous minutus (black noddy)", "Anous stolidus (brown noddy)", "Gygis alba (white tern)", "Sula sula (red-footed booby)")
labels=c(expression(italic("Anous minutus")~(black noddy)), "Anous stolidus (brown noddy)", "Gygis alba (white tern)", "Sula sula (red-footed booby)")
sb_bio_stack_plot2<-
sb_dat_focal_nests_motu_sp%>%
ggplot(aes(fill = SpeciesName, y = biomass_kg_ha, x = Motu))+
geom_bar(position = "stack", stat =  "identity")+
ylab("Seabird breeding biomass (kg/ha)")+
xlab("")+
scale_fill_brewer( palette = "Spectral",
name = "Species",
breaks=c("Aminutus",  "Astolidus", "Galba",  "Ssula"),
# labels=c("Anous minutus (black noddy)", "Anous stolidus (brown noddy)", "Gygis alba (white tern)", "Sula sula (red-footed booby)")
labels=c(expression(paste(italic("Anous minutus"),"(black noddy)")), "Anous stolidus (brown noddy)", "Gygis alba (white tern)", "Sula sula (red-footed booby)")
)+
scale_x_discrete(labels = c('reference','recovering','unrestored'))+
theme_bw()+
theme(panel.grid.major = element_blank(), # remove gridlines
panel.grid.minor = element_blank(), #remove gridlines
strip.background = element_blank(),
# legend.position = c(.75,.8)
legend.position = "none",
axis.text=element_text(size=12),
axis.title=element_text(size=12)
)
sb_bio_stack_plot2
sb_bio_stack_plot2<-
sb_dat_focal_nests_motu_sp%>%
ggplot(aes(fill = SpeciesName, y = biomass_kg_ha, x = Motu))+
geom_bar(position = "stack", stat =  "identity")+
ylab("Seabird breeding biomass (kg/ha)")+
xlab("")+
scale_fill_brewer( palette = "Spectral",
name = "Species",
breaks=c("Aminutus",  "Astolidus", "Galba",  "Ssula"),
# labels=c("Anous minutus (black noddy)", "Anous stolidus (brown noddy)", "Gygis alba (white tern)", "Sula sula (red-footed booby)")
labels=c(expression(paste(italic("Anous minutus"),"(black noddy)")), "Anous stolidus (brown noddy)", "Gygis alba (white tern)", "Sula sula (red-footed booby)")
)+
scale_x_discrete(labels = c('reference','recovering','unrestored'))+
theme_bw()+
theme(panel.grid.major = element_blank(), # remove gridlines
panel.grid.minor = element_blank(), #remove gridlines
strip.background = element_blank(),
# legend.position = c(.75,.8)
#  legend.position = "none",
axis.text=element_text(size=12),
axis.title=element_text(size=12)
)
sb_bio_stack_plot2
sb_dens_stack_plot2<-
sb_dat_focal_nests_motu_sp%>%
ggplot(aes(fill = SpeciesName, y = Density_ha, x = Motu))+
geom_bar(position = "stack", stat =  "identity")+
ylab("Seabird breeding density (individuals/ha)")+
xlab("")+
scale_fill_brewer(palette = "Spectral",  name = "Species",
breaks=c("Aminutus",  "Astolidus", "Galba",  "Ssula"),
labels=c(expression(paste(italic("Anous minutus"),"(black noddy)")), expression(paste(italic("Anous stolidus"),"(brown noddy)")), expression(paste(italic("Gygis alba"),"(white tern)")), expression(paste(italic("ula sula "),"(red-footed booby)")))
)+ #
scale_x_discrete(labels = c('reference','recovering','unrestored'))+
theme_bw()+
theme(panel.grid.major = element_blank(), # remove gridlines
panel.grid.minor = element_blank(), #remove gridlines
strip.background = element_blank(),
legend.position = c(.75,.8),
axis.text=element_text(size=12),
axis.title=element_text(size=12)
)
sb_dens_stack_plot2
sb_dens_stack_plot2<-
sb_dat_focal_nests_motu_sp%>%
ggplot(aes(fill = SpeciesName, y = Density_ha, x = Motu))+
geom_bar(position = "stack", stat =  "identity")+
ylab("Seabird breeding density (individuals/ha)")+
xlab("")+
scale_fill_brewer(palette = "Spectral",  name = "Species",
breaks=c("Aminutus",  "Astolidus", "Galba",  "Ssula"),
labels=c(expression(paste(italic("Anous minutus"),"(black noddy)")), expression(paste(italic("Anous stolidus"),"(brown noddy)")), expression(paste(italic("Gygis alba"),"(white tern)")), expression(paste(italic("Sula sula "),"(red-footed booby)")))
)+ #
scale_x_discrete(labels = c('reference','recovering','unrestored'))+
theme_bw()+
theme(panel.grid.major = element_blank(), # remove gridlines
panel.grid.minor = element_blank(), #remove gridlines
strip.background = element_blank(),
legend.position = c(.75,.8),
axis.text=element_text(size=12),
axis.title=element_text(size=12)
)
sb_dens_stack_plot2
sb_bio_stack_plot2<-
sb_dat_focal_nests_motu_sp%>%
ggplot(aes(fill = SpeciesName, y = biomass_kg_ha, x = Motu))+
geom_bar(position = "stack", stat =  "identity")+
ylab("Seabird breeding biomass (kg/ha)")+
xlab("")+
scale_fill_brewer( palette = "Spectral",
name = "Species",
breaks=c("Aminutus",  "Astolidus", "Galba",  "Ssula"),
labels=c(expression(paste(italic("Anous minutus"),"(black noddy)")), expression(paste(italic("Anous stolidus"),"(brown noddy)")), expression(paste(italic("Gygis alba"),"(white tern)")), expression(paste(italic("Sula sula "),"(red-footed booby)")))
)+
scale_x_discrete(labels = c('reference','recovering','unrestored'))+
theme_bw()+
theme(panel.grid.major = element_blank(), # remove gridlines
panel.grid.minor = element_blank(), #remove gridlines
strip.background = element_blank(),
# legend.position = c(.75,.8)
legend.position = "none",
axis.text=element_text(size=12),
axis.title=element_text(size=12)
)
sb_bio_stack_plot2
seabird_stack_plots2<-plot_grid(sb_bio_stack_plot2, sb_dens_stack_plot2, labels = "auto", label_fontface = "plain")
seabird_stack_plots2
ggsave(filename = "outputs/Supp_Fig_seabird_stack_plots.jpg",    plot = seabird_stack_plots2,    width = 10,  height = 5,    units = "in",   dpi = 500)
ggsave(filename = "outputs/Supp_Fig_seabird_stack_plots.pdf",    plot = seabird_stack_plots2,    width = 10,  height = 5,    units = "in",   dpi = 500)
seabird_focal_all_meta_for_corr<-as.data.frame(seabird_focal_all_meta[,6:21])
cor.mtest(seabird_focal_all_meta_for_corr)
cor.mtest(seabird_focal_all_meta_for_corr, method = "spearman")
cor(seabird_focal_all_meta_for_corr, method = "spearman")
cor(seabird_focal_all_meta_for_corr, method = "pearson")
##PEARSON----
correlation.matrix <- cor(seabird_focal_all_meta_for_corr, use = "pairwise.complete.obs")
write.csv(correlation.matrix, "outputs/seabird_metrics_corrmatrix.csv")
corrplot(cor(seabird_focal_all_meta_for_corr, use = "pairwise.complete.obs"), type = "upper",
addCoef.col = NULL, addCoefasPercent = FALSE, tl.col = "black", tl.cex = 0.5, title = "Seabirds")
pdf(file = "outputs/seabirds_corrplot.pdf")
corrplot(cor(seabird_focal_all_meta_for_corr, use = "pairwise.complete.obs"), type = "upper",
addCoef.col = NULL, addCoefasPercent = FALSE, tl.col = "black", tl.cex = 0.5, title = "Seabirds")
dev.off()
##SPEARMAN----
correlation.matrix <- cor(seabird_focal_all_meta_for_corr, use = "pairwise.complete.obs", method = "spearman")
write.csv(correlation.matrix, "outputs/seabird_metrics_corrmatrix_SPEARMAN.csv")
corrplot(cor(seabird_focal_all_meta_for_corr, use = "pairwise.complete.obs", method = "spearman"), type = "upper",addCoef.col = "black", addCoefasPercent = FALSE, tl.col = "black", tl.cex = 0.5, title = "Seabirds")
pdf(file = "outputs/seabirds_corrplot_SPEARMAN.pdf")
corrplot(cor(seabird_focal_all_meta_for_corr, use = "pairwise.complete.obs", method = "spearman"), type = "upper",
addCoef.col = NULL, addCoefasPercent = FALSE, tl.col = "black", tl.cex = 0.5)
dev.off()
#all strong corrs....
corrplot(cor(seabird_focal_all_meta_for_corr, use = "pairwise.complete.obs"), type = "upper",
addCoef.col = NULL, addCoefasPercent = FALSE, tl.col = "black", tl.cex = 0.5, title = "Seabirds")
#get estimates using emmeans:-----
emmeans(sb_br_bio_space_mod_log_lm_int, list(pairwise ~ protection|rat.eradication.status), adjust = "fdr", type = "response")
#get estimates using emmeans:-----
emmeans(sb_br_bio_space_mod_log_lm_int, list(pairwise ~ protection|rat.eradication.status), adjust = "fdr")
sb_br_bio_space_mod_log_lm_int.rg <- update(ref_grid(sb_br_bio_space_mod_log_lm_int), tran = "log") #THIS LINE IS CLUTCH*** Now don't have to use link transformations, can use log response and still backtransform with emmeans
emmeans(sb_br_bio_space_mod_log_lm_int.rg, list(pairwise ~ protection|rat.eradication.status), adjust = "fdr", type = "response")
?emmeans
EMM_rat <- emmeans(sb_br_bio_space_mod_log_lm_int, ~ protection * rat.eradication.status)
EMM_rat
EMM_rat <- emmeans(sb_br_bio_space_mod_log_lm_int.rg, ~ protection * rat.eradication.status)
EMM_rat
EMM_rat <- emmeans(sb_br_bio_space_mod_log_lm_int, ~ protection * rat.eradication.status, type = "response")
EMM_rat
pairs(EMM_rat, simple = "protection", type = "response", regrid = "response")
pairs(EMM_rat, simple = "protection",  regrid = "response")
pairs(EMM_rat, simple = "protection", type = "response")
test(EMM_rat)
emmeans(sb_br_bio_space_mod_log_lm_int.rg, list(pairwise ~ protection|rat.eradication.status), adjust = "fdr", type = "response")
EMM_rat
test(EMM_rat, simple = "protectin")
test(EMM_rat, simple = "protection")
pairs(EMM_rat, simple = "protection")
pairs(EMM_rat, simple = "protection", type = "response")
emmeans(sb_br_bio_space_mod_log_lm_int, list(pairwise ~  protection * rat.eradication.status), simple = "protection", adjust = "fdr", type = "response")
exp(.471)
sb_br_bio_space_mod_log_lm_int.rg%>%
emmeans("protection",
by=c("rat.eradication.status"),
type="response")%>%
contrast("revpairwise")
#get estimates using emmeans:-----
emmeans(sb_br_bio_space_mod_log_lm_int, list(pairwise ~ protection|rat.eradication.status), adjust = "fdr", type = "response")
#get estimates using emmeans:-----
emmeans(regrid(sb_br_bio_space_mod_log_lm_int), list(pairwise ~ protection|rat.eradication.status), adjust = "fdr", type = "response")
#get estimates using emmeans:-----
emmeans(regrid(sb_br_bio_space_mod_log_lm_int), list(pairwise ~ protection|rat.eradication.status), adjust = "fdr", type = "response")
pairs(regrid(EMM_rat), simple = "protection", type = "response")
pairs(regrid(EMM_rat), simple = "protection", type = "response", adjust = "fdr")
emmeans(sb_br_bio_space_mod_log_lm_int, list(pairwise ~  protection * rat.eradication.status), simple = "protection", adjust = "fdr", type = "response")
test(pairs(EMM_rat, by = "protection"), by = NULL, adjust = "fdr")
test(pairs(EMM_rat, by = "protection"), by = NULL, adjust = "fdr",
)
test(pairs(emmeans(sb_br_bio_space_mod_log_lm_2int, ~ protection | rat.eradication.status, adjust = "fdr", type = "response")))
test(pairs(emmeans(sb_br_bio_space_mod_log_lm_int, ~ protection | rat.eradication.status, adjust = "fdr", type = "response")))
test(pairs(emmeans(sb_br_bio_space_mod_log_lm_int, ~ rat.eradication.status | protection, adjust = "fdr", type = "response")))
test(emmeans(sb_br_bio_space_mod_log_lm_int, ~ rat.eradication.status, adjust = "fdr", type = "response"))
emmeans(sb_br_bio_space_mod_log_lm_int, list(revpairwise ~ protection | rat.eradication.status), type = "response", adjust = "fdr")
emmeans(sb_br_bio_space_mod_log_lm_int, list(revpairwise ~ rat.eradication.status), type = "response", adjust = "fdr")
emmeans(sb_br_bio_space_mod_log_lm_int, list(pairwise ~ rat.eradication.status),  adjust = "fdr")
regrid(emmeans(sb_br_bio_space_mod_log_lm_int, list(pairwise ~ rat.eradication.status),  adjust = "fdr"))
#get estimates using emmeans:-----
#overall estimates:
regrid(emmeans(sb_br_bio_space_mod_log_lm_int, list(~ rat.eradication.status)))
emmeans(sb_br_bio_space_mod_log_lm_int, list(~ rat.eradication.status))
#pairwise comparisons, first by rat eradication status:
emmeans(sb_br_bio_space_mod_log_lm_int, list(pairwise ~ rat.eradication.status),  adjust = "fdr")
regrid(emmeans(sb_br_bio_space_mod_log_lm_int, list(pairwise ~ rat.eradication.status),  adjust = "fdr"))
pairs(regrid(EMM_rat), simple = "protection", type = "response", adjust = "fdr")
EMM_rat <- emmeans(sb_br_bio_space_mod_log_lm_int, ~ protection * rat.eradication.status, type = "response")
pairs(regrid(EMM_rat), simple = "protection", type = "response", adjust = "fdr")
pairs(regrid(EMM_rat), simple = "rat.eradication.status", type = "response", adjust = "fdr")
pairs(regrid(EMM_rat), simple = "rat.eradication.status", type = "response", adjust = "fdr")
EMM_rat <- emmeans(sb_br_bio_space_mod_log_lm_int, type = "response")
EMM_rat <- emmeans(sb_br_bio_space_mod_log_lm_int, ~  rat.eradication.status, type = "response")
pairs(regrid(EMM_rat), simple = "rat.eradication.status", type = "response", adjust = "fdr")
emmeans(sb_br_bio_space_mod_log_lm_int, list(pairwise ~ protection|rat.eradication.status), type = "response", adjust = "fdr", lmer.df = "asymptotic")
emmeans(sb_br_bio_space_mod_log_lm_int, list(pairwise ~ protection|rat.eradication.status), type = "response", adjust = "fdr", lmer.df = "asymptotic")
pairs(regrid(EMM_rat), simple = "rat.eradication.status", type = "response", adjust = "fdr")
emmeans(sb_br_bio_space_mod_log_lm_int, list(pairwise ~ protection|rat.eradication.status), type = "response", adjust = "fdr", lmer.df = "asymptotic")
exp(-0.823)
exp(0.823)
exp(0.316)
library(tidyverse)
library(lme4)
library(car)
library(jtools)
library(vegan)
library(emmeans)
library(RColorBrewer)
library(cowplot)
library(corrplot)
#load seabird data----
load("outputs/seabird_dens_bio_data.RData")
#load seabird data----
load("../outputs/seabird_dens_bio_data.RData")
#load seabird data----
load("../outputs/seabird_dens_bio_data.RData")
#by species:
#sb_dat_focal_nests_motu_sp
#sb_dat_focal_nests_100m_sp
#sb_dat_focal_nests_200m_sp
#sb_dat_focal_nests_side_sp
#sb_dat_focal_adults_motu_sp
#sb_dat_focal_adults_100m_sp
#sb_dat_focal_adults_200m_sp
#sb_dat_focal_adults_side_sp
#plus iti by species:
#sb_dat_iti_adults_sp
#sb_dat_iti_nests_sp
#aggregated:
#seabird_focal_all
#seabird_side_w_iti
#load metadata----
site_metdata<-read.csv("../metadata/TARP_Nov2021_site_metadata_version2.csv")
sb_br_bio_space_mod_log_lm_3int<-lm(log(breeding_biomass+1)~ rat.eradication.status * protection * spatial_scale,
data = seabird_focal_all_meta_long)
summary(sb_br_bio_space_mod_log_lm_3int)
#can't do 3-way interaction - not enough power.  So proceed with 2-way interactions:
sb_br_bio_space_mod_log_lm_2int<-lm(log(breeding_biomass+1)~ rat.eradication.status * protection + spatial_scale*rat.eradication.status + protection*spatial_scale,
data = seabird_focal_all_meta_long)
summary(sb_br_bio_space_mod_log_lm_2int)
plot(sb_br_bio_space_mod_log_lm_2int) #plots/assumptions look okay
anova(sb_br_bio_space_mod_log_lm_2int)
Anova(sb_br_bio_space_mod_log_lm_2int)#same as anova
#marginal interaction between protection*eradication status.  eradication status also significant
#get estimates using emmeans:
sb_br_bio_space_mod_log_lm_2int %>%
emmeans(~ protection|rat.eradication.status,
type = "response")
#where rats present, similar low densities across both sides
#but where no rats, trend towards higher biomass on protected sides within each motu. Strongest pattern on Aie....Really this is because RFB's nest on north side but not south side of motu.
sb_br_bio_space_mod_log_lm_2int %>%
emmeans(~ rat.eradication.status,
type = "response")
#re-run non-logged model just to check:
sb_br_bio_space_mod_lm_2int<-lm(breeding_biomass~ rat.eradication.status * protection + spatial_scale*rat.eradication.status + protection*spatial_scale,
data = seabird_focal_all_meta_long)
summary(sb_br_bio_space_mod_lm_2int)
anova(sb_br_bio_space_mod_lm_2int)
#now interaction between rats*protection p = .05325, protection = .04, rat status = .001
plot(sb_br_bio_space_mod_lm_2int) #plots/assumptions actually look okay
sb_br_bio_space_mod_lm_2int %>%
emmeans(~ protection|rat.eradication.status,
type = "response")
#doesn't make much sense because CIs falling below 0, not biologically realistic.  So go with log model:
sb_br_bio_space_mod_log_lm_2int %>%
emmeans(~ rat.eradication.status|protection,
type = "response")
sb_br_bio_space_mod_log_lm_2int %>%
emmeans(~ protection|rat.eradication.status,
type = "response")
EMM_rat <- emmeans(sb_br_bio_space_mod_log_lm_2int, ~ protection * rat.eradication.status)
pairs(EMM_rat, simple = "rat.eradication.status", type = "response")
#so when split by side, actually eradicated 2018 and rat-free are the same (p = 0.16).  But on protected side all 3 levels different.
pairs(EMM_rat, simple = "protection", type = "response")
#and when split by rat status, only rat-free has sig different exposed versus protected....
test(pairs(EMM_rat, by = "rat.eradication.status"), by = NULL, adjust = "mvt")
test(pairs(EMM_rat, by = "rat.eradication.status"), by = NULL, adjust = "none")
test(pairs(EMM_rat, by = "protection"), by = NULL, adjust = "mvt")
test(pairs(EMM_rat, by = "protection"), by = NULL, adjust = "none")
test(pairs(EMM_rat, by = "protection"), by = NULL, adjust = "fdr")
test(pairs(EMM_rat, by = "protection"), by = NULL, adjust = "fdr",
)
test(pairs(emmeans(sb_br_bio_space_mod_log_lm_2int, ~ protection | rat.eradication.status, adjust = "fdr", type = "response")))
test(pairs(emmeans(sb_br_bio_space_mod_log_lm_2int, ~ rat.eradication.status | protection, adjust = "fdr", type = "response")))
test(emmeans(sb_br_bio_space_mod_log_lm_2int, ~ rat.eradication.status, adjust = "fdr", type = "response"))
emmeans(sb_br_bio_space_mod_log_lm_2int, list(revpairwise ~ protection | rat.eradication.status), type = "response", adjust = "fdr")
emmeans(sb_br_bio_space_mod_log_lm_2int, list(revpairwise ~ rat.eradication.status), type = "response", adjust = "fdr")
emmeans(sb_br_bio_space_mod_log_lm_2int, list(pairwise ~ rat.eradication.status), type = "response", adjust = "fdr")
#need to decide best method for extracting p-values**** Currently using ANOVA table for overall p-values, and emmeans for estimates and pairwise comparisons****
exp(3.055)
exp(4.041)
emmeans(sb_br_bio_space_mod_log_lm_2int, pairwise ~ protection | rat.eradication.status, transform = "response")
pairs(EMM_rat, simple = "protection", type = "response", ratios = TRUE)
install.packages("emmeans")
install.packages("emmeans")
install.packages("emmeans")
library(tidyverse)
library(lme4)
library(car)
library(jtools)
library(vegan)
library(emmeans)
library(RColorBrewer)
library(cowplot)
library(corrplot)
#load seabird data----
load("outputs/seabird_dens_bio_data.RData")
#by species:
#sb_dat_focal_nests_motu_sp
#sb_dat_focal_nests_100m_sp
#sb_dat_focal_nests_200m_sp
#sb_dat_focal_nests_side_sp
#sb_dat_focal_adults_motu_sp
#sb_dat_focal_adults_100m_sp
#sb_dat_focal_adults_200m_sp
#sb_dat_focal_adults_side_sp
#plus iti by species:
#sb_dat_iti_adults_sp
#sb_dat_iti_nests_sp
#aggregated:
#seabird_focal_all
#seabird_side_w_iti
#load metadata----
site_metdata<-read.csv("../metadata/TARP_Nov2021_site_metadata_version2.csv")
str(site_metdata)
str(seabird_focal_all)
str(site_metdata)
#in seabird data - change to lowercase, change name of exposure -> "protection"
seabird_focal_all2<-
seabird_focal_all%>%
rename_with(tolower)%>%
mutate(motu = str_to_lower(motu),
exposure = str_to_lower(exposure))%>%
rename(protection = exposure)
seabird_focal_all2
seabird_focal_all_meta<-right_join(select(site_metdata,
c("motu", "site.name", "protection", "island.side", "rat.eradication.status")), seabird_focal_all2, by = join_by(motu, protection))
seabird_focal_all_meta
sb_dat_focal_nests_motu_sp %>%
group_by(SpeciesName)%>%
summarize(sum_abundance = sum(Abundance),
sum_density = sum(Density_ha),
sum_biomass = sum(biomass_kg_ha))
#density:
4.210526/(4.210526+268.823529	+13.034056	+382.807018) #0.006294936
268.823529/(4.210526+268.823529	+13.034056	+382.807018) #0.4019039
13.034056/(4.210526+268.823529	+13.034056	+382.807018) #0.01948653
382.807018/(4.210526+268.823529	+13.034056	+382.807018) #0.5723146
#biomass:
0.4736842/(0.4736842+50.8076471	+1.5249845	+373.2368421) #0.001111822
50.8076471/(0.4736842+50.8076471	+1.5249845	+373.2368421) #0.1192547
1.5249845/(0.4736842+50.8076471	+1.5249845	+373.2368421) #0.003579413
373.2368421/(0.4736842+50.8076471	+1.5249845	+373.2368421) #0.8760541
seabird_focal_all_meta
#start with breeding biomass:
seabird_focal_all_meta_br_bio<-
seabird_focal_all_meta[,(1:9)]
seabird_focal_all_meta_br_bio
seabird_focal_all_meta_long<-pivot_longer(seabird_focal_all_meta_br_bio,
cols = starts_with("breeding_biomass_kgha"),
names_to = "spatial_scale",
values_to = "breeding_biomass")%>%
mutate(spatial_scale = str_remove(spatial_scale, 'breeding_biomass_kgha_'))
seabird_focal_all_meta_long
