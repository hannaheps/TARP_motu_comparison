ggplot() +
geom_text(data=nmds_fish_log_dens_spp.sc,aes(x=NMDS1,y=NMDS2,label=Species), alpha = .2) +  # add the species labels -
geom_point(data=nmds_fish_log_dens_site_scores,aes(x=NMDS1,y=NMDS2,colour=site.name, fill = site.name, pch = site.name), stat="identity", size=5, alpha = .9) +
geom_polygon(data=hull.data,aes(x=NMDS1,y=NMDS2,fill=site.name,group=site.name),alpha=0.30) + # add the convex hulls
coord_fixed() + ## need aspect ratio of 1!
geom_segment(data = sb.scrs,
aes(x = 0, xend = NMDS1, y = 0, yend = NMDS2),
arrow = arrow(length = unit(0.25, "cm")), colour = "black") +
geom_text(data = sb.scrs, aes(x = NMDS1, y = NMDS2, label = "seabirds"),
size = 3, vjust = 2)+
theme_bw() +
theme(panel.grid.major = element_blank(), # remove gridlines
panel.grid.minor = element_blank(), #remove gridlines
strip.background = element_blank(), #remove gray boxes
text = element_text(size=20))
##add arrows
sb.scrs <- as.data.frame(scores(ord.fit, display = "vectors"))
sb.scrs <- cbind(sb.scrs, Species = rownames(sb.scrs))
nmds_fish_log_dens_spp.sc2<-
nmds_fish_log_dens_spp.sc%>%
mutate(Species= str_remove_all(Species, "_percent_cover"))
fish_dens_log_nmds_plot<-
ggplot() +
geom_text(data=nmds_fish_log_dens_spp.sc,aes(x=NMDS1,y=NMDS2,label=Species), alpha = .2) +  # add the species labels -
geom_point(data=nmds_fish_log_dens_site_scores,aes(x=NMDS1,y=NMDS2,colour=site.name, fill = site.name, pch = site.name), stat="identity", size=5, alpha = .9) +
geom_polygon(data=hull.data,aes(x=NMDS1,y=NMDS2,fill=site.name,group=site.name),alpha=0.30) + # add the convex hulls
coord_fixed() + ## need aspect ratio of 1!
geom_segment(data = sb.scrs,
aes(x = 0, xend = NMDS1, y = 0, yend = NMDS2),
arrow = arrow(length = unit(0.25, "cm")), colour = "black") +
geom_text(data = sb.scrs, aes(x = NMDS1, y = NMDS2, label = "seabirds"),
size = 3, vjust = 2)+
theme_bw() +
theme(panel.grid.major = element_blank(), # remove gridlines
panel.grid.minor = element_blank(), #remove gridlines
strip.background = element_blank(), #remove gray boxes
text = element_text(size=20))
benthic_video_nmds_plot
fish_dens_log_nmds_plot
fish_dens_log_nmds_plot<-
ggplot() +
geom_text(data=nmds_fish_log_dens_spp.sc,aes(x=NMDS1,y=NMDS2,label=Species), alpha = .2) +  # add the species labels -
geom_point(data=nmds_fish_log_dens_site_scores,aes(x=NMDS1,y=NMDS2,colour=site.name, fill = site.name, pch = site.name), stat="identity", size=5, alpha = .9) +
geom_polygon(data=hull.data,aes(x=NMDS1,y=NMDS2,fill=site.name,group=site.name),alpha=0.30) + # add the convex hulls
coord_fixed() + ## need aspect ratio of 1!
geom_segment(data = sb.scrs,
aes(x = 0, xend = NMDS1, y = 0, yend = NMDS2),
arrow = arrow(length = unit(0.25, "cm")), colour = "black") +
geom_text(data = sb.scrs, aes(x = NMDS1, y = NMDS2),
size = 3, vjust = 2)+
theme_bw() +
theme(panel.grid.major = element_blank(), # remove gridlines
panel.grid.minor = element_blank(), #remove gridlines
strip.background = element_blank(), #remove gray boxes
text = element_text(size=20))
fish_dens_log_nmds_plot
sb.scrs
fish_dens_log_nmds_plot<-
ggplot() +
geom_text(data=nmds_fish_log_dens_spp.sc,aes(x=NMDS1,y=NMDS2,label=Species), alpha = .2) +  # add the species labels -
geom_point(data=nmds_fish_log_dens_site_scores,aes(x=NMDS1,y=NMDS2,colour=site.name, fill = site.name, pch = site.name), stat="identity", size=5, alpha = .9) +
geom_polygon(data=hull.data,aes(x=NMDS1,y=NMDS2,fill=site.name,group=site.name),alpha=0.30) + # add the convex hulls
coord_fixed() + ## need aspect ratio of 1!
geom_segment(data = sb.scrs,
aes(x = 0, xend = NMDS1, y = 0, yend = NMDS2),
arrow = arrow(length = unit(0.25, "cm")), colour = "black") +
geom_text(data = sb.scrs, aes(x = NMDS1, y = NMDS2, label = sb.scrs$Species),
size = 3, vjust = 2)+
theme_bw() +
theme(panel.grid.major = element_blank(), # remove gridlines
panel.grid.minor = element_blank(), #remove gridlines
strip.background = element_blank(), #remove gray boxes
text = element_text(size=20))
fish_dens_log_nmds_plot
plot(nmds_fish_log_dens.rotate)
ord.fit<-envfit(nmds_fish_log_dens.rotate~breeding_biomass_kgha_side+protection + start_distance_to_shore_m + depth_max_m + structural_complexity_0to5, data = fish.dens.seabirds.trans, na.rm=TRUE)
ord.fit #marginal effect of seabirds, no effect of protection.
plot(ord.fit)
#draw polygons and arrows
ordihull(nmds_fish_log_dens.rotate, fish.dens.seabirds.trans$breeding_biomass_kgha_side, pty=3)
ggsave(fish_dens_log_nmds_plot, file = "../output/seabird-fish/fish_log_dens_fg_nmds_plot.jpg",
width = 7, height = 5)
tet_fish_dens_div_comm_dat
tet_fish_div_comm_tl_dat
nmds_fish_diet_log_site_scores
nmds_fish_diet_log_bio_site_scores
tet_fish_dens_div_comm_dat
#total density, and diversity stats based on density:
fish_dens_div_dat<-
tet_fish_dens_div_comm_dat%>%
select(c(motu, site.name, wind.exposure, transect, shannon, evenness, sum_dens, PD, SR))
tet_fish_div_comm_tl_dat
#relative biomass by trophic level:
fish_tl_bio_dat<-
tet_fish_div_comm_tl_dat%>%
select(c(motu, site.name, wind.exposure, transect, rel_bio_TL1, rel_bio_TL2, rel_bio_TL3, rel_bio_TL4, rel_bio_TL5))
nmds_fish_diet_log_site_scores
?rename_with
#density by feeding group/diet:
fish_fg_dens_dat<-
nmds_fish_diet_log_site_scores%>%
select(c(motu, site.name, wind.exposure, transect, Herb, InvMob, Omnivr, Plktiv, FisCep))%>%
rename_with(~pasteo(.,"_density"), is.numeric())
#density by feeding group/diet:
fish_fg_dens_dat<-
nmds_fish_diet_log_site_scores%>%
select(c(motu, site.name, wind.exposure, transect, Herb, InvMob, Omnivr, Plktiv, FisCep))%>%
rename_with(~pasteo(.,"_density"), Herb:FisCep)
#density by feeding group/diet:
fish_fg_dens_dat<-
nmds_fish_diet_log_site_scores%>%
select(c(motu, site.name, wind.exposure, transect, Herb, InvMob, Omnivr, Plktiv, FisCep))%>%
rename_with(~paste0(.,"_density"), Herb:FisCep)
fish_fg_dens_dat
#biomass by feeding group/diet:
fish_fg_bio_dat<-
nmds_fish_diet_log_bio_site_scores%>%
select(c(motu, site.name, wind.exposure, transect, Herb, InvMob, Omnivr, Plktiv, FisCep))%>%
rename_with(~paste0(.,"_biomass"), Herb:FisCep)
fish_fg_bio_dat
#biomass by feeding group/diet:
fish_fg_bio_dat<-
nmds_fish_diet_log_bio_site_scores%>%
select(c(motu, site.name, wind.exposure, transect, Herb, InvMob, Omnivr, Plktiv, FisCep))%>%
rename_with(~paste0(.,"_biomass"), Herb:FisCep)%>%
rowwise%>%
mutate(sum_fish_biomass = sum(c_across(Herb_biomass:InvSes_biomass)))%>%
ungroup
nmds_fish_diet_log_bio_site_scores%>%
select(c(motu, site.name, wind.exposure, transect, Herb, InvMob, Omnivr, Plktiv, FisCep))%>%
rename_with(~paste0(.,"_biomass"), Herb:FisCep)
nmds_fish_diet_log_bio_site_scores
#biomass by feeding group/diet:
fish_fg_bio_dat<-
nmds_fish_diet_log_bio_site_scores%>%
select(c(motu, site.name, wind.exposure, transect, Herb, InvMob, Omnivr, Plktiv, FisCep))%>%
rename_with(~paste0(.,"_biomass"), Herb:FisCep)%>%
rowwise%>%
mutate(sum_fish_biomass = sum(c_across(Herb_biomass:InvSes_biomass)))%>%
ungroup
nmds_fish_diet_log_bio_site_scores
nmds_fish_diet_log_site_scores
#density by feeding group/diet:
fish_fg_dens_dat<-
nmds_fish_diet_log_site_scores%>%
select(c(motu, site.name, wind.exposure, transect, Herb, InvMob, Omnivr, Plktiv, FisCep, InvSes))%>%
rename_with(~paste0(.,"_density"), Herb:InvSes)
fish_fg_dens_dat
#biomass by feeding group/diet:
fish_fg_bio_dat<-
nmds_fish_diet_log_bio_site_scores%>%
select(c(motu, site.name, wind.exposure, transect, Herb, InvMob, Omnivr, Plktiv, FisCep, InvSes))%>%
rename_with(~paste0(.,"_biomass"), Herb:InvSes)%>%
rowwise%>%
mutate(sum_fish_biomass = sum(c_across(Herb_biomass:InvSes_biomass)))%>%
ungroup
fish_fg_bio_dat
fish_fg_dens_dat
fish.bio.seabirds.trans
#biomass by feeding group/diet, and keep in metadata from above:
fish_fg_bio_dat<-
fish.bio.seabirds.trans%>%
select(c(motu, site.name, wind.exposure, start_distance_to_shore_m, end_distance_to_shore_m,
depth_min_m, depth_max_m, structural_complexity_0to5, breeding_biomass_kgha_side,
transect, Herb, InvMob, Omnivr, Plktiv, FisCep, InvSes))%>%
rename_with(~paste0(.,"_biomass"), Herb:InvSes)%>%
rowwise%>%
mutate(sum_fish_biomass = sum(c_across(Herb_biomass:InvSes_biomass)))%>%
ungroup
fish_fg_bio_dat
fish_dens_div_dat
tet_fish_dens_div_comm_dat
#total density, and diversity stats based on density:
fish_dens_div_dat<-
tet_fish_dens_div_comm_dat%>%
select(c(motu, site.name, wind.exposure, transect, shannon, evenness, sum_dens, PD, SR))%>%
mutate(protection = if_else(wind.exposure == "Leeward", "Protected", "Exposed"))%>%
relocate(protection, .before = wind.exposure)%>%
mutate(motu = str_to_title(motu))%>%
unite("site.name", c(motu, protection), sep = "_", remove = FALSE)
fish_dens_div_dat
#relative biomass by trophic level:
fish_tl_bio_dat<-
tet_fish_div_comm_tl_dat%>%
select(c(motu, site.name, wind.exposure, transect, rel_bio_TL1, rel_bio_TL2, rel_bio_TL3, rel_bio_TL4, rel_bio_TL5))%>%
mutate(protection = if_else(wind.exposure == "Leeward", "Protected", "Exposed"))%>%
relocate(protection, .before = wind.exposure)%>%
mutate(motu = str_to_title(motu))%>%
unite("site.name", c(motu, protection), sep = "_", remove = FALSE)
#density by feeding group/diet:
fish_fg_dens_dat<-
nmds_fish_diet_log_site_scores%>%
select(c(motu, site.name, wind.exposure, transect, Herb, InvMob, Omnivr, Plktiv, FisCep, InvSes))%>%
rename_with(~paste0(.,"_density"), Herb:InvSes)%>%
mutate(protection = if_else(wind.exposure == "Leeward", "Protected", "Exposed"))%>%
relocate(protection, .before = wind.exposure)%>%
mutate(motu = str_to_title(motu))%>%
unite("site.name", c(motu, protection), sep = "_", remove = FALSE)
#now combine----
fish_comb_dat_1<- full_join(fish_dens_div_dat, fish_tl_bio_dat, by = c("motu", "site.name", "wind.exposure", "protection", "transect"))
fish_comb_dat_1
fish_comb_dat_2<- full_join(fish_comb_dat_1, fish_fg_dens_dat, by = c("motu", "site.name", "wind.exposure", "protection", "transect"))
fish_comb_dat<- full_join(fish_comb_dat_2, fish_fg_bio_dat, by = c("motu", "site.name", "wind.exposure", "protection", "transect"))
fish_comb_dat<- full_join(fish_comb_dat_2, fish_fg_bio_dat, by = c("motu", "site.name", "wind.exposure",  "transect"))
fish_comb_dat
fish_comb_dat_1
fish_fg_dens_dat
tet_fish_div_comm_tl_dat
#relative biomass by trophic level:
fish_tl_bio_dat<-
tet_fish_div_comm_tl_dat%>%
select(c(motu, site.name, wind.exposure, transect, rel_bio_TL1, rel_bio_TL2, rel_bio_TL3, rel_bio_TL4, rel_bio_TL5))%>%
mutate(protection = if_else(wind.exposure == "leeward", "Protected", "Exposed"))%>%
relocate(protection, .before = wind.exposure)%>%
mutate(motu = str_to_title(motu))%>%
unite("site.name", c(motu, protection), sep = "_", remove = FALSE)
fish_tl_bio_dat
fish_comb_dat_2<- full_join(fish_comb_dat_1, fish_fg_dens_dat, by = c("motu", "site.name", "wind.exposure", "protection", "transect"))
fish_comb_dat_2
fish_comb_dat<- full_join(fish_comb_dat_2, fish_fg_bio_dat, by = c("motu", "site.name", "wind.exposure",  "transect"))
fish_comb_dat
fish_comb_dat<- full_join(fish_comb_dat_2, fish_fg_bio_dat, by = c("motu", "site.name", "wind.exposure",  "transect"))
fish_comb_dat
fish_fg_bio_dat
fish_comb_dat_2
fish_fg_bio_dat
fish_comb_dat<- full_join(fish_comb_dat_2, fish_fg_bio_dat, by = c("motu", "site.name", "wind.exposure",  "transect"))
fish_comb_dat
#total density, and diversity stats based on density:
fish_dens_div_dat<-
tet_fish_dens_div_comm_dat%>%
select(c(motu, site.name, wind.exposure, transect, shannon, evenness, sum_dens, PD, SR))%>%
mutate(protection = if_else(wind.exposure == "Leeward", "Protected", "Exposed"))%>%
relocate(protection, .before = wind.exposure)%>%
mutate(motu = str_to_title(motu))%>%
unite("site.name", c(motu, protection), sep = "_", remove = FALSE)
#relative biomass by trophic level:
fish_tl_bio_dat<-
tet_fish_div_comm_tl_dat%>%
select(c(motu, site.name, wind.exposure, transect, rel_bio_TL1, rel_bio_TL2, rel_bio_TL3, rel_bio_TL4, rel_bio_TL5))%>%
mutate(protection = if_else(wind.exposure == "leeward", "Protected", "Exposed"))%>%
relocate(protection, .before = wind.exposure)%>%
mutate(motu = str_to_title(motu))%>%
unite("site.name", c(motu, protection), sep = "_", remove = FALSE)
#density by feeding group/diet:
fish_fg_dens_dat<-
nmds_fish_diet_log_site_scores%>%
select(c(motu, site.name, wind.exposure, transect, Herb, InvMob, Omnivr, Plktiv, FisCep, InvSes))%>%
rename_with(~paste0(.,"_density"), Herb:InvSes)%>%
mutate(protection = if_else(wind.exposure == "Leeward", "Protected", "Exposed"))%>%
relocate(protection, .before = wind.exposure)%>%
mutate(motu = str_to_title(motu))%>%
unite("site.name", c(motu, protection), sep = "_", remove = FALSE)
fish_fg_dens_dat
#biomass by feeding group/diet, and keep in metadata from above:
fish_fg_bio_dat<-
fish.bio.seabirds.trans%>%
select(c(motu, site.name, wind.exposure, start_distance_to_shore_m, end_distance_to_shore_m,
depth_min_m, depth_max_m, structural_complexity_0to5, breeding_biomass_kgha_side,
transect, Herb, InvMob, Omnivr, Plktiv, FisCep, InvSes))%>%
rename_with(~paste0(.,"_biomass"), Herb:InvSes)%>%
rowwise%>%
mutate(sum_fish_biomass = sum(c_across(Herb_biomass:InvSes_biomass)))%>%
ungroup
fish_fg_bio_dat
#total density, and diversity stats based on density:
fish_dens_div_dat<-
tet_fish_dens_div_comm_dat%>%
select(c(motu, site.name, wind.exposure, transect, shannon, evenness, sum_dens, PD, SR))%>%
mutate(protection = if_else(wind.exposure == "Leeward", "Protected", "Exposed"))%>%
relocate(protection, .before = wind.exposure)%>%
mutate(motu = str_to_title(motu))%>%
unite("site.name", c(motu, protection), sep = "_", remove = FALSE)
fish_dens_div_dat
tet_fish_dens_div_comm_dat
#total density, and diversity stats based on density:
fish_dens_div_dat<-
tet_fish_dens_div_comm_dat%>%
select(c(motu, site.name, wind.exposure, transect, shannon, evenness, sum_dens, PD, SR))%>%
mutate(protection = if_else(wind.exposure == "leeward", "Protected", "Exposed"))%>%
relocate(protection, .before = wind.exposure)%>%
mutate(motu = str_to_title(motu))%>%
unite("site.name", c(motu, protection), sep = "_", remove = FALSE)
#relative biomass by trophic level:
fish_tl_bio_dat<-
tet_fish_div_comm_tl_dat%>%
select(c(motu, site.name, wind.exposure, transect, rel_bio_TL1, rel_bio_TL2, rel_bio_TL3, rel_bio_TL4, rel_bio_TL5))%>%
mutate(protection = if_else(wind.exposure == "leeward", "Protected", "Exposed"))%>%
relocate(protection, .before = wind.exposure)%>%
mutate(motu = str_to_title(motu))%>%
unite("site.name", c(motu, protection), sep = "_", remove = FALSE)
#density by feeding group/diet:
fish_fg_dens_dat<-
nmds_fish_diet_log_site_scores%>%
select(c(motu, site.name, wind.exposure, transect, Herb, InvMob, Omnivr, Plktiv, FisCep, InvSes))%>%
rename_with(~paste0(.,"_density"), Herb:InvSes)%>%
mutate(protection = if_else(wind.exposure == "Leeward", "Protected", "Exposed"))%>%
relocate(protection, .before = wind.exposure)%>%
mutate(motu = str_to_title(motu))%>%
unite("site.name", c(motu, protection), sep = "_", remove = FALSE)
fish_fg_dens_dat
#biomass by feeding group/diet, and keep in metadata from above:
fish_fg_bio_dat<-
fish.bio.seabirds.trans%>%
select(c(motu, site.name, wind.exposure, start_distance_to_shore_m, end_distance_to_shore_m,
depth_min_m, depth_max_m, structural_complexity_0to5, breeding_biomass_kgha_side,
transect, Herb, InvMob, Omnivr, Plktiv, FisCep, InvSes))%>%
rename_with(~paste0(.,"_biomass"), Herb:InvSes)%>%
rowwise%>%
mutate(sum_fish_biomass = sum(c_across(Herb_biomass:InvSes_biomass)))%>%
ungroup
fish_fg_bio_dat
#now combine----
fish_comb_dat_1<- full_join(fish_dens_div_dat, fish_tl_bio_dat, by = c("motu", "site.name", "wind.exposure", "protection", "transect"))
fish_comb_dat_1
fish_comb_dat_2<- full_join(fish_comb_dat_1, fish_fg_dens_dat, by = c("motu", "site.name", "wind.exposure", "protection", "transect"))
fish_comb_dat_2
fish_comb_dat<- full_join(fish_comb_dat_2, fish_fg_bio_dat, by = c("motu", "site.name", "wind.exposure",  "transect"))
fish_comb_dat
nmds_fish_diet_log_site_scores
#density by feeding group/diet:
fish_fg_dens_dat<-
nmds_fish_diet_log_site_scores%>%
select(c(motu, site.name, wind.exposure, transect, Herb, InvMob, Omnivr, Plktiv, FisCep, InvSes))%>%
rename_with(~paste0(.,"_density"), Herb:InvSes)%>%
mutate(protection = if_else(wind.exposure == "leeward", "Protected", "Exposed"))%>%
relocate(protection, .before = wind.exposure)%>%
mutate(motu = str_to_title(motu))%>%
unite("site.name", c(motu, protection), sep = "_", remove = FALSE)
fish_fg_dens_dat
#biomass by feeding group/diet, and keep in metadata from above:
fish_fg_bio_dat<-
fish.bio.seabirds.trans%>%
select(c(motu, site.name, wind.exposure, start_distance_to_shore_m, end_distance_to_shore_m,
depth_min_m, depth_max_m, structural_complexity_0to5, breeding_biomass_kgha_side,
transect, Herb, InvMob, Omnivr, Plktiv, FisCep, InvSes))%>%
rename_with(~paste0(.,"_biomass"), Herb:InvSes)%>%
rowwise%>%
mutate(sum_fish_biomass = sum(c_across(Herb_biomass:InvSes_biomass)))%>%
ungroup
fish_fg_bio_dat
#now combine----
fish_comb_dat_1<- full_join(fish_dens_div_dat, fish_tl_bio_dat, by = c("motu", "site.name", "wind.exposure", "protection", "transect"))
fish_comb_dat_1
fish_comb_dat_2<- full_join(fish_comb_dat_1, fish_fg_dens_dat, by = c("motu", "site.name", "wind.exposure", "protection", "transect"))
fish_comb_dat_2
fish_comb_dat<- full_join(fish_comb_dat_2, fish_fg_bio_dat, by = c("motu", "site.name", "wind.exposure",  "transect"))
fish_comb_dat
fish_comb_dat<- full_join(fish_fg_bio_dat, fish_comb_dat_2, by = c("motu", "site.name", "wind.exposure",  "transect"))
fish_comb_dat
fish_comb_dat<- full_join(fish_fg_bio_dat, select(fish_comb_dat_2,-protection), by = c("motu", "site.name", "wind.exposure",  "transect"))
fish_comb_dat
#biomass by feeding group/diet, and keep in metadata from above:
fish_fg_bio_dat<-
fish.bio.seabirds.trans%>%
select(c(motu, site.name,transect, wind.exposure, start_distance_to_shore_m, end_distance_to_shore_m,
depth_min_m, depth_max_m, structural_complexity_0to5, breeding_biomass_kgha_side,
Herb, InvMob, Omnivr, Plktiv, FisCep, InvSes))%>%
rename_with(~paste0(.,"_biomass"), Herb:InvSes)%>%
rowwise%>%
mutate(sum_fish_biomass = sum(c_across(Herb_biomass:InvSes_biomass)))%>%
ungroup
fish_fg_bio_dat
#now combine----
fish_comb_dat_1<- full_join(fish_dens_div_dat, fish_tl_bio_dat, by = c("motu", "site.name", "wind.exposure", "protection", "transect"))
fish_comb_dat_1
fish_comb_dat_2<- full_join(fish_comb_dat_1, fish_fg_dens_dat, by = c("motu", "site.name", "wind.exposure", "protection", "transect"))
fish_comb_dat_2
fish_comb_dat<- full_join(fish_fg_bio_dat, select(fish_comb_dat_2,-protection), by = c("motu", "site.name", "wind.exposure",  "transect"))
fish_comb_dat
#biomass by feeding group/diet, and keep in metadata from above:
fish_fg_bio_dat<-
fish.bio.seabirds.trans%>%
select(c(motu, site.name,wind.exposure, transect, start_distance_to_shore_m, end_distance_to_shore_m,
depth_min_m, depth_max_m, structural_complexity_0to5, breeding_biomass_kgha_side,
Herb, InvMob, Omnivr, Plktiv, FisCep, InvSes))%>%
rename_with(~paste0(.,"_biomass"), Herb:InvSes)%>%
rowwise%>%
mutate(sum_fish_biomass = sum(c_across(Herb_biomass:InvSes_biomass)))%>%
ungroup
fish_fg_bio_dat
#now combine----
fish_comb_dat_1<- full_join(fish_dens_div_dat, fish_tl_bio_dat, by = c("motu", "site.name", "wind.exposure", "protection", "transect"))
fish_comb_dat_1
fish_comb_dat_2<- full_join(fish_comb_dat_1, fish_fg_dens_dat, by = c("motu", "site.name", "wind.exposure", "protection", "transect"))
fish_comb_dat_2
fish_comb_dat<- full_join(fish_fg_bio_dat, select(fish_comb_dat_2,-protection), by = c("motu", "site.name", "wind.exposure",  "transect"))
fish_comb_dat
fish_comb_dat_for_corr<-fish_comb_dat(fish.bio.seabirds[,5:33])
fish_comb_dat_for_corr<-fish_comb_dat(fish_comb_dat[,5:33])
fish_comb_dat_for_corr<-as.data.frame(fish_comb_dat[,5:33])
cor.mtest(fish_comb_dat_for_corr)
correlation.matrix <- cor(fish_comb_dat_for_corr, use = "pairwise.complete.obs")
correlation.matrix
write.csv(correlation.matrix, "../output/seabird-fish/seabirds_fish_all_corrmatrix.csv")
corrplot(cor(fish_comb_dat_for_corr, use = "pairwise.complete.obs"), type = "upper",
addCoef.col = NULL, addCoefasPercent = FALSE, tl.col = "black", tl.cex = 0.5, title = "Seabirds-Fish FG")
pdf(file = "../output/seabird-fish/seabirds_fish_all_corrplot.pdf")
corrplot(cor(fish_comb_dat_for_corr, use = "pairwise.complete.obs"), type = "upper",
addCoef.col = NULL, addCoefasPercent = FALSE, tl.col = "black", tl.cex = 0.5, title = "Seabirds-Fish FG")
dev.off()
##remove seabird as predictor and see-----
sb_fish_bio_tot_log_mod3<-lmer(log(total_fish_bio)~  wind.exposure + structural_complexity_0to5 + depth_max_m + start_distance_to_shore_m + (1|motu), data = fish.bio.seabirds.trans.tot)
summary(sb_fish_bio_tot_log_mod3)
plot_summs(sb_fish_bio_tot_log_mod3)
summary(sb_fish_bio_tot_log_mod3)
plot(sb_fish_bio_tot_log_mod3)
Anova(sb_fish_bio_tot_log_mod3)
vif(sb_fish_bio_tot_log_mod3)
##remove seabird as predictor and see-----
sb_fish_bio_tot_log_mod3<-lmer(log(total_fish_bio)~  wind.exposure + structural_complexity_0to5 + depth_max_m + start_distance_to_shore_m + (1|site.name), data = fish.bio.seabirds.trans.tot)
summary(sb_fish_bio_tot_log_mod3)
plot(sb_fish_bio_tot_log_mod3)
Anova(sb_fish_bio_tot_log_mod3)
plot(sb_fish_bio_tot_log_mod3)
vif(sb_fish_bio_tot_log_mod3)
plot_summs(sb_fish_bio_tot_log_mod3)
##remove seabird as predictor and see-----
sb_fish_bio_tot_log_mod3<-lmer(log(total_fish_bio)~  wind.exposure + structural_complexity_0to5 + depth_max_m  + (1|site.name), data = fish.bio.seabirds.trans.tot)
summary(sb_fish_bio_tot_log_mod3)
plot(sb_fish_bio_tot_log_mod3)
Anova(sb_fish_bio_tot_log_mod3)
vif(sb_fish_bio_tot_log_mod3)
##remove seabird as predictor and see-----
sb_fish_bio_tot_log_mod3<-lmer(total_fish_bio~  wind.exposure + structural_complexity_0to5 + depth_max_m  + (1|site.name), data = fish.bio.seabirds.trans.tot)
summary(sb_fish_bio_tot_log_mod3)
plot(sb_fish_bio_tot_log_mod3)
Anova(sb_fish_bio_tot_log_mod3)
vif(sb_fish_bio_tot_log_mod3)
plot_summs(sb_fish_bio_tot_log_mod3)
##remove seabird as predictor and see-----
sb_fish_bio_tot_log_mod3<-lmer(total_fish_bio~  structural_complexity_0to5   + (1|site.name), data = fish.bio.seabirds.trans.tot)
summary(sb_fish_bio_tot_log_mod3)
plot(sb_fish_bio_tot_log_mod3)
Anova(sb_fish_bio_tot_log_mod3)
vif(sb_fish_bio_tot_log_mod3)
plot_summs(sb_fish_bio_tot_log_mod3)
##remove seabird as predictor and see-----
sb_fish_bio_tot_log_mod3<-lmer(log(total_fish_bio) ~  structural_complexity_0to5   + (1|site.name), data = fish.bio.seabirds.trans.tot)
summary(sb_fish_bio_tot_log_mod3)
plot(sb_fish_bio_tot_log_mod3)
Anova(sb_fish_bio_tot_log_mod3)
##remove seabird as predictor and see-----
sb_fish_bio_tot_mod3<-lmer(total_fish_bio ~  structural_complexity_0to5   + (1|motu), data = fish.bio.seabirds.trans.tot)
summary(sb_fish_bio_tot_log_mod3)
plot(sb_fish_bio_tot_log_mod3)
Anova(sb_fish_bio_tot_log_mod3)
##remove seabird as predictor and see-----
sb_fish_bio_tot_mod3<-lmer(total_fish_bio ~  wind.exposure + structural_complexity_0to5 + depth_max_m + start_distance_to_shore_m    + (1|site.name), data = fish.bio.seabirds.trans.tot)
summary(sb_fish_bio_tot_log_mod3)
##remove seabird as predictor and see-----
sb_fish_bio_tot_mod3<-lmer(total_fish_bio ~  wind.exposure + structural_complexity_0to5 + depth_max_m + start_distance_to_shore_m    + (1|site.name), data = fish.bio.seabirds.trans.tot)
summary(sb_fish_bio_tot_mod3)
plot(sb_fish_bio_tot_mod3)
Anova(sb_fish_bio_tot_mod3)
vif(sb_fish_bio_tot_mod3)
plot_summs(sb_fish_bio_tot_mod3)
##remove seabird as predictor and see-----
sb_fish_bio_tot_mod3<-lmer(total_fish_bio ~  wind.exposure + structural_complexity_0to5 + depth_max_m + start_distance_to_shore_m    + (1|motu), data = fish.bio.seabirds.trans.tot)
summary(sb_fish_bio_tot_mod3)
plot(sb_fish_bio_tot_mod3)
Anova(sb_fish_bio_tot_mod3)
##remove seabird as predictor and see-----
sb_fish_bio_tot_mod3<-lmer(total_fish_bio ~  structural_complexity_0to5  + (1|site.name), data = fish.bio.seabirds.trans.tot)
summary(sb_fish_bio_tot_mod3)
plot(sb_fish_bio_tot_mod3)
Anova(sb_fish_bio_tot_mod3)
vif(sb_fish_bio_tot_mod3)
plot_summs(sb_fish_bio_tot_mod3)
fish_comb_dat
fish_comb_dat%>%
pivot_longer(cols = c(rel_bio_TL1:rel_bio_TL5),
names_to = "trophic_level",
values_to = "relative_biomass")%>%
group_by(trophic_level, site.name)%>%
summarize(mean_rel_bio = mean(relative_biomass))%>%
# mutate(trophic_level = as.factor(trophic_level))%>%
#  mutate(feeding_group = fct_relevel(feeding_group, c("Herb", "Omnivr", "Plktiv", "InvSes", "InvMob", "FisCep")))%>%
ggplot(aes(fill = trophic_level, y = mean_rel_bio, x = site.name))+
geom_bar(position = "stack", stat =  "identity")+
scale_fill_brewer(palette = "Set2")+
xlab("")+
ylab("mean biomass (kg/ha)")+
theme_bw()+
theme(panel.grid.major = element_blank(), # remove gridlines
panel.grid.minor = element_blank(), #remove gridlines
strip.background = element_blank(),
axis.text.x = element_text(angle = 45, hjust = 1)
)
fish_tl_bio_stack_barplot<-
fish_comb_dat%>%
pivot_longer(cols = c(rel_bio_TL1:rel_bio_TL5),
names_to = "trophic_level",
values_to = "relative_biomass")%>%
group_by(trophic_level, site.name)%>%
summarize(mean_rel_bio = mean(relative_biomass))%>%
# mutate(trophic_level = as.factor(trophic_level))%>%
#  mutate(feeding_group = fct_relevel(feeding_group, c("Herb", "Omnivr", "Plktiv", "InvSes", "InvMob", "FisCep")))%>%
ggplot(aes(fill = trophic_level, y = mean_rel_bio, x = site.name))+
geom_bar(position = "stack", stat =  "identity")+
scale_fill_brewer(palette = "Set2")+
xlab("")+
ylab("mean relative biomass")+
theme_bw()+
theme(panel.grid.major = element_blank(), # remove gridlines
panel.grid.minor = element_blank(), #remove gridlines
strip.background = element_blank(),
axis.text.x = element_text(angle = 45, hjust = 1)
)
fish_tl_bio_stack_barplot
ggsave(fish_tl_bio_stack_barplot, file = "../output/seabird-fish/fish_trophic_level_rel_bio_stack_barplot.jpg",
width = 7, height = 5)
